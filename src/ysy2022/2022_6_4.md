# 2022-6-4

完成了对代码的预处理和词法分析。

预处理很简单，因为不需要制作宏操作，所以只需要删除注释，然后修改回车键。

词法分析中比较麻烦的是对常数进行分析。需要考虑很多种情况。

我对数字所做的分析过程大致如下：

```
main {
    如果 str[1] 满足 isdigit or '.'

    那么判断为数字 jmp digit

    否则下一个判断
}

digit {
    如果前缀为

        `0x` `0X` jmp xdigit

        `0` jmp odigit

        `.` jmp float

    否则 jmp ddigit

}

xdigit {
    如果遇上 `.` `p` `P` jmp xfloat

    否则处理十六进制数字
}

odigit {
    处理八进制数字
}

ddigit {
    如果遇上 `.` `e` `E` jmp float

    否则处理十进制数字
}

float {
    处理十进制浮点数
}

xfloat {
    处理十六进制浮点数
}
```

个人认为正负号不应该在这一步处理。它应该归类到符号处处理。

我们假定失去左操作数的 `plus` 和 `minus` ，有默认左操作数 `0`。这样子假定后，绝对值相等的两个整数如果负号相反，是不会被看作两个数字的。

对于标点符号，我使用了比较贪心的方法，先直接考虑是否能和下一个字符组成双字符符号，如果不行，再考虑单个。

对于空白字符，跳过。

对于标识符，先判断 `isalpha`，`_` 再进入子过程，考虑是否为 `isalnum`，`_`。

整体在处理的时候没有错误处理功能，这将在最后考虑。

尽量在每一个应该报错的地方加上 `error !!!` 注释。

接下来就是语法分析和中间代码生成。

目前决定使用四元式作为中间代码。

目前决定使用递归下降分析法和语法制导翻译尝试生成。